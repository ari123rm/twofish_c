#include "./std_defs.h"
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define Q_TABLES
#define M_TABLE
#define MK_TABLE
#define ONE_STEP

static char *alg_name[] = { "twofish", "twofish.c", "twofish" };
char **cipher_name(void) { return alg_name; }

u4byte k_len;
u4byte l_key[40];
u4byte s_key[4];

/* GF(2^8) arithmetic */
#define G_M 0x0169
u1byte tab_5b[4] = {0, G_M >> 2, G_M >> 1, (G_M >> 1) ^ (G_M >> 2)};
u1byte tab_ef[4] = {0, (G_M >> 1) ^ (G_M >> 2), G_M >> 1, G_M >> 2};

#define ffm_01(x) (x)
#define ffm_5b(x) ((x) ^ ((x) >> 2) ^ tab_5b[(x) & 3])
#define ffm_ef(x) ((x) ^ ((x) >> 1) ^ ((x) >> 2) ^ tab_ef[(x) & 3])

u1byte ror4[16] = {0, 8, 1, 9, 2, 10, 3, 11, 4, 12, 5, 13, 6, 14, 7, 15};
u1byte ashx[16] = {0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12, 5, 14, 7};

u1byte qt0[2][16] = {
    {8, 1, 7, 13, 6, 15, 3, 2, 0, 11, 5, 9, 14, 12, 10, 4},
    {2, 8, 11, 13, 15, 7, 6, 14, 3, 1, 9, 4, 0, 10, 12, 5}
};
u1byte qt1[2][16] = {
    {14, 12, 11, 8, 1, 2, 3, 5, 15, 4, 10, 6, 7, 0, 9, 13},
    {1, 14, 2, 11, 4, 12, 3, 7, 6, 13, 10, 5, 15, 9, 0, 8}
};
u1byte qt2[2][16] = {
    {11, 10, 5, 14, 6, 13, 9, 0, 12, 8, 15, 3, 2, 4, 7, 1},
    {4, 12, 7, 5, 1, 6, 9, 10, 0, 14, 13, 8, 2, 11, 3, 15}
};
u1byte qt3[2][16] = {
    {13, 7, 15, 4, 1, 2, 6, 14, 9, 11, 3, 0, 8, 5, 12, 10},
    {11, 9, 5, 1, 12, 3, 13, 14, 6, 4, 7, 15, 2, 0, 8, 10}
};

u1byte qp(const u4byte n, const u1byte x)
{
    u1byte a0, a1, a2, a3, a4, b0, b1, b2, b3, b4;
    a0 = x >> 4; b0 = x & 15;
    a1 = a0 ^ b0; b1 = ror4[b0] ^ ashx[a0];
    a2 = qt0[n][a1]; b2 = qt1[n][b1];
    a3 = a2 ^ b2; b3 = ror4[b2] ^ ashx[a2];
    a4 = qt2[n][a3]; b4 = qt3[n][b3];
    return (b4 << 4) | a4;
}

#ifdef Q_TABLES
u4byte qt_gen = 0;
u1byte q_tab[2][256];
#define q(n, x) q_tab[n][x]
void gen_qtab(void)
{
    u4byte i;
    for (i = 0; i < 256; ++i) {
        q(0, i) = qp(0, (u1byte)i);
        q(1, i) = qp(1, (u1byte)i);
    }
}
#else
#define q(n,x) qp(n,x)
#endif

#ifdef M_TABLE
u4byte mt_gen = 0;
const u4byte m_tab[4][256] ={{-1128517003,-320069133,538985414,-1280062988,-623246373,33721211,-488494085,-1633748280,-909513654,-724301357,404253670,505323371,-1734865339,-1296942979,-1499016472,640071499,1010587606,-1819047374,-2105348392,1381144829,2071712823,-1145358479,1532729329,1195869153,606354480,1364320783,-1162164488,1246425883,-1077983097,218984698,-1330597114,1970658879,-757924514,2105352378,1717973422,976921435,1499012234,0,-842165316,437969053,-1364317075,2139073473,724289457,-1094797042,-522149760,-1970663331,993743570,1684323029,-656897888,-404249212,1600120839,454758676,741130933,-50547568,825304876,-2139069021,1936927410,202146163,2037997388,1802191188,1263207058,1397975412,-1802203338,-2088558767,707409464,-993747792,572704957,-707397542,-1111636996,1212708960,-12702,1280051094,1094809452,-943200702,-336911113,471602192,1566401404,909517352,1734852647,-370561140,1145370899,336915093,-168445028,-808511289,1061104932,-1061100730,1920129851,1414818928,690572490,-252693021,134807173,-960096309,-202158319,-1936923440,-1532733037,-892692808,1751661478,-1195881085,943204384,-437965057,-1381149025,185304183,-926409277,-1717960756,1482222851,421108335,235801096,-1785364801,1886408768,-134795033,1852755755,522153698,-1246413447,151588620,1633760426,1465325186,-1616966847,-1650622406,286352618,623234489,-1347428892,1162152090,-538997340,-1549575017,-353708674,892688602,-303181702,1128528919,-117912730,-67391084,926405537,-84262883,-1027446723,-1263219472,842161630,-1667468877,1448535819,-471606670,-2021171033,353704732,-101106961,1667481553,875866451,-1701149378,-1313783153,2088554803,-2004313306,1027450463,-1583228948,-454762634,-2122214358,-1852767927,252705665,-286348664,370565614,-673746143,-1751648828,-1515870182,-16891925,1835906521,2021174981,-976917191,488498585,1987486925,1044307117,-875862223,-1229568117,-269526271,303177240,1616954659,1785376989,1296954911,-825300658,-555844563,1431674361,2122209864,555856463,50559730,-1600117147,1583225230,1515873912,1701137244,1650609752,-33733351,101119117,1077970661,-218972520,859024471,387420263,84250239,-387424763,1330609508,-1987482961,269522275,1953771446,168457726,1549570805,-1684310857,757936956,808507045,774785486,1229556201,1179021928,2004309316,-1465329440,-1768553395,673758531,-1448531607,-640059095,-2038001362,-774797396,-185316843,-1920133799,-690584920,-1179010038,1111625118,-151600786,791656519,-572717345,589510964,-859020747,-235813782,-1044311345,-2054820900,-1886413278,1903272393,-1869549376,-1431678053,16904585,-1953766956,1313770733,-1903267925,-1414815214,1869561506,-421112819,-606342574,-1835893829,-1212697086,1768540719,960092585,-741143337,-1482218655,-1566397154,-1010591308,1819034704,117900548,67403766,656885442,-1397971178,-791644635,1347425158,-589498538,-2071717291,-505327351,2054825406,320073617},
		{-1445381831,1737496343,-1284399972,-388847962,67438343,-40349102,-1553629056,1994384612,-1710734011,-1845343413,-2136940320,2019973722,-455233617,-575640982,-775986333,943073834,223667942,-968679392,895667404,-1732316430,404623890,-148575253,-321412703,1819754817,1136470056,1966259388,936672123,647727240,-93319923,335103044,-1800274949,1213890174,-226884861,-790328180,-1958234442,809247780,-2069501977,1413573483,-553198115,600137824,424017405,1537423930,1030275778,1494584717,-215880468,-1372494234,-1572966545,-2112465065,1670713360,22802415,-2092058440,781289094,-642421395,1361019779,-1689015638,2086886749,-1506056088,-348127490,-1512689616,-1104840070,380087468,202311945,-483004176,1629726631,-1057976176,-1934628375,981507485,-174957476,1937837068,740766001,628543696,199710294,-1149529454,1323945678,-1980694271,1805590046,1403597876,1791291889,-1264991293,-241738917,-511490233,-429189096,-1110957534,1158584472,-496099553,-188107853,-1238403980,1724643576,-855664231,-1779821548,65886296,1459084508,-723416181,471536917,514695842,-687025197,-81009950,-1021458232,-1910940066,-1245565908,-376878775,-820854335,-1082223211,-1172275843,-362540783,2005142283,963495365,-1351972471,869366908,-912166543,1657733119,1899477947,-2114253041,2034087349,156361185,-1378075074,606945087,-844859786,-107129515,-655457662,-444186560,-978421640,-1177737947,1292146326,1146451831,134876686,-2045554608,-416221193,-1579993289,490797818,-1439407775,-309572018,112439472,1886147668,-1305840781,-766362821,1091280799,2072707586,-1601644328,290452467,828885963,-1035589849,666920807,-1867186948,539506744,-159448060,1618495560,-13703707,-1777906612,1548445029,-1312347349,-1418752370,-1643298238,-1665403403,1391647707,468929098,1604730173,-1822841692,180140473,-281347591,-1846602989,-2046949368,1224839569,-295627242,763158238,1337073953,-1891454543,1004237426,1203253039,-2025275457,1831644846,1189331136,-698926020,1048943258,1764338089,1685933903,714375553,-834064850,-887634234,801794409,-54280771,-1755536477,90106088,2060512749,-1400385071,2140013829,-709204892,447260069,1270294054,247054014,-1486846073,1526257109,673330742,336665371,1071543669,695851481,-2002063634,1009986861,1281325433,45529015,-1198077238,-631753419,-1331903292,402408259,1427801220,536235341,-1977853607,2100867762,1470903091,-954675249,-1913387514,1953059667,-1217094757,-990537833,-1621709395,1926947811,2127948522,357233908,580816783,312650667,1481532002,132669279,-1713038051,876159779,1858205430,1346661484,-564317646,1752319558,1697030304,-1131164211,-620504358,-121193798,-923099490,-1467820330,735014510,1079013488,-588544635,-25884150,847942547,-1534205985,-900978391,269753372,561240023,-255019852,-754330412,1561365130,266490193,0,1872369945,-1646257638,915379348,1122420679,1257032137,1593692882,-1045725313,-522671960},
		{-1133134798,-319558623,549855299,-1275808823,-623126013,41616011,-486809045,-1631019270,-917845524,-724315127,417732715,510336671,-1740269554,-1300385224,-1494702382,642459319,1020673111,-1825401974,-2099739922,1392333464,2067233748,-1150174409,1542544279,1205946243,607134780,1359958498,-1158104378,1243302643,-1081622712,234491248,-1341738829,1967093214,-765537539,2109373728,1722705457,979057315,1502239004,0,-843264621,446503648,-1368543700,2143387563,733031367,-1106329927,-528424800,-1973581296,1003633490,1691706554,-660547448,-410720347,1594318824,454302481,750070978,-57606988,824979751,-2136768411,1941074730,208866433,2035054943,1800694593,1267878658,1400132457,-1808362353,-2091810017,708323894,-995048292,582820552,-715467272,-1107509821,1214269560,-10289202,1284918279,1097613687,-951924762,-336073948,470817812,1568431459,908604962,1730635712,-376641105,1142113529,345314538,-174262853,-808988904,1059340077,-1069104925,1916498651,1416647788,701114700,-253497291,142936318,-959724009,-216927409,-1932489500,-1533828007,-893859178,1755736123,-1199327155,941635624,-436214482,-1382044330,192351108,-926693347,-1714644481,1476614381,426711450,235408906,-1782606466,1883271248,-135792848,1848340175,534912878,-1250314947,151783695,1638555956,1468159766,-1623089397,-1657102976,300552548,632890829,-1343967267,1167738120,-542842995,-1550343332,-360781099,903492952,-310710832,1125598204,-127469365,-74122319,933312467,-98698688,-1036139928,-1259293492,853422685,-1665950607,1443583719,-479009830,-2019063968,354161947,-101713606,1674666943,877868201,-1707173243,-1315983038,2083749073,-2010740581,1029651878,-1578327593,-461970209,-2127920748,-1857449727,260116475,-293015894,384702049,-685648013,-1748723723,-1524980312,-18088385,1842965941,2026207406,-986069651,496573925,1993176740,1051541212,-885929113,-1232357817,-285085861,303567390,1612931269,1792895664,1293897206,-833696023,-567419268,1442403741,2118680154,558834098,66192250,-1603952602,1586388505,1517836902,1700554059,1649959502,-48628411,109905652,1088766086,-224857410,861352876,392632208,92210574,-402266018,1331974013,-1984984726,274927765,1958114351,184420981,1559583890,-1682465932,758918451,816132310,785264201,1240025481,1181238898,2000975701,-1461671720,-1773300220,675489981,-1452693207,-651568775,-2043771247,-777203321,-199887798,-1923511019,-693578110,-1190479428,1117667853,-160500031,793194424,-572531450,590619449,-868889502,-244649532,-1043349230,-2049145365,-1893560418,1909027233,-1866428176,-1432638893,25756145,-1949004831,1324174988,-1901359505,-1424839774,1872916286,-435296684,-615326734,-1833201029,-1224558666,1764714954,967391705,-740830452,-1486772445,-1575050579,-1011563623,1817209924,117704453,83231871,667035462,-1407800153,-802828170,1350979603,-598287113,-2074770406,-519446191,2059303461,328274927},
		{-650532391,-1877514352,1906094961,-760813358,84345861,-1739391592,1702929253,-538675489,138779144,38507010,-1595899744,1717205094,-575675171,-1335173712,-1083977281,908736566,1424362836,1126221379,1657550178,-1091397442,504502302,619444004,-677253929,2000776311,-1121434691,851211570,-730122284,-1685576037,1879964272,-112978951,-1308912463,1518225498,2047079034,-460533532,1203145543,1009004604,-1511553883,1097552961,115203846,-983555131,1174214981,-1556456541,1757560168,361584917,569176865,828812849,1047503422,374833686,-1794088043,1542390107,1303937869,-1853477231,-1251092043,528699679,1403689811,1667071075,996714043,1073670975,-701454890,628801061,-1481894233,252251151,904979253,598171939,-258948880,-1343648593,-2137179520,-1839401582,-2129890431,657533991,1993352566,-413791257,2073213819,-372355351,-251557391,-1625396321,-1456188503,-990811452,-1715227495,-1755582057,-2092441213,1796793963,-937247288,244860174,1847583342,-910953271,796177967,-872913205,-6697729,-367749654,-312998931,-136554761,-510929695,454368283,-1381884243,215209740,736295723,499696413,425627161,-1037257278,-1991644791,314691346,2123743102,545110560,1678895716,-2079623292,1841641837,1787408234,-780389423,-1586378335,-822123826,935031095,-82869765,1035303229,1373702481,-599872036,759112749,-1535717980,-1655309923,-293414674,-2042567290,-1367816786,-853165619,76958980,1433879637,168691722,324044307,821552944,-751328813,1090133312,878815796,-1940984436,-1280309581,1817473132,712225322,1379652178,194986251,-1962771573,-1999069048,1341329743,1741369703,1177010758,-1066981440,-1258516300,674766888,2131031679,2018009208,786825006,122459655,1264933963,-953437753,1871620975,222469645,-1141531461,-220507406,-213246989,-1505927258,1503957849,-1128723780,989458234,-283930129,-32995842,26298625,1628892769,2094935420,-1306439758,1118932802,-613270565,-1204861000,1220511560,749628716,-473938205,1463604823,-2053489019,698968361,2102355069,-1803474284,1227804233,398904087,-899076150,-1010959165,1554224988,1592264030,-789742896,-2016301945,-1912242290,-1167796806,-1465574744,-1222227017,-1178726727,1619502944,-120235272,573974562,286987281,-562741282,2044275065,-1427208022,858602547,1601784927,-1229520202,-1765099370,1479924312,-1664831332,-62711812,444880154,-162717706,475630108,951221560,-1405921364,416270104,-200897036,1767076969,1956362100,-174603019,1454219094,-622628134,-706052395,1257510218,-1634786658,-1565846878,1315067982,-396425240,-451044891,958608441,-1040814399,1147949124,1563614813,1917216882,648045862,-1815233389,64674563,-960825146,-90257158,-2099861374,-814863409,1349533776,-343548693,1963654773,-1970064758,-1914723187,1277807180,337383444,1943478643,-860557108,164942601,277503248,-498003998,0,-1709609062,-535126560,-1886112113,-423148826,-322352404,-36544771,-1417690709,-660021032}};


#define mds(n,x) m_tab[n][x]
#endif

/* h_fun */
u4byte h_fun(const u4byte x, const u4byte key[])
{
    u4byte b0 = byte(x,0), b1 = byte(x,1), b2 = byte(x,2), b3 = byte(x,3);

    switch(k_len) {
        case 4:
            b0 = q(1,b0) ^ byte(key[3],0);
            b1 = q(0,b1) ^ byte(key[3],1);
            b2 = q(0,b2) ^ byte(key[3],2);
            b3 = q(1,b3) ^ byte(key[3],3);
            /* fallthrough */
        case 3:
            b0 = q(1,b0) ^ byte(key[2],0);
            b1 = q(1,b1) ^ byte(key[2],1);
            b2 = q(0,b2) ^ byte(key[2],2);
            b3 = q(0,b3) ^ byte(key[2],3);
            /* fallthrough */
        case 2:
            b0 = q(0,q(0,b0) ^ byte(key[1],0)) ^ byte(key[0],0);
            b1 = q(0,q(1,b1) ^ byte(key[1],1)) ^ byte(key[0],1);
            b2 = q(1,q(0,b2) ^ byte(key[1],2)) ^ byte(key[0],2);
            b3 = q(1,q(1,b3) ^ byte(key[1],3)) ^ byte(key[0],3);
            break;
    }
    return mds(0,b0) ^ mds(1,b1) ^ mds(2,b2) ^ mds(3,b3);
}

/* prototype for mds_rem */
u4byte mds_rem(u4byte p0, u4byte p1);

/* MK_TABLE */
#ifdef MK_TABLE
#ifdef ONE_STEP
const u4byte mk_tab[4][256] = {{-1734865339,-1819047374,656885442,1263207058,218984698,1600120839,555856463,-724301357,-1970663331,842161630,-875862223,-1145358479,-16891925,-505327351,-2054820900,404253670,690572490,-707397542,-1566397154,421108335,-168445028,84250239,117900548,1852755755,-471606670,-640059095,-2122214358,1684323029,-303181702,1094809452,-791644635,1195869153,-741143337,1734852647,976921435,-1499016472,353704732,-404249212,1313770733,-1869549376,1987486925,1566401404,-1532733037,589510964,-2021171033,-960096309,-1296942979,1431674361,1819034704,-1246413447,134807173,1145370899,1667481553,-1684310857,1532729329,-1701149378,-842165316,1027450463,-1482218655,1549570805,-437965057,-589498538,774785486,1482222851,-825300658,-1852767927,926405537,-134795033,-808511289,1397975412,1061104932,1111625118,-387424763,437969053,1465325186,-976917191,2088554803,-421112819,-67391084,791656519,-2088558767,370565614,1246425883,741130933,-606342574,-1128517003,1162152090,-84262883,538985414,-1515870182,1751661478,-101106961,-269526271,252705665,1448535819,-185316843,185304183,-286348664,2139073473,-1061100730,-1751648828,-218972520,1229556201,2021174981,-454762634,-117912730,-757924514,2004309316,-1229568117,859024471,-1600117147,-1549575017,168457726,-202158319,572704957,-859020747,16904585,-673746143,724289457,2037997388,-320069133,707409464,-538997340,943204384,-370561140,454758676,-1162164488,1650609752,387420263,67403766,-1397971178,1717973422,1381144829,1953771446,202146163,-993747792,-1920133799,-2004313306,-12702,2122209864,522153698,-252693021,-656897888,-151600786,-774797396,-1094797042,320073617,-1717960756,-555844563,606354480,1296954911,993743570,-1886413278,-50547568,-623246373,-1313783153,0,1010587606,303177240,-1179010038,1920129851,-1044311345,960092585,-1212697086,505323371,875866451,1280051094,-1768553395,1869561506,2054825406,-1802203338,-353708674,-1465329440,-943200702,1768540719,-572717345,-1616966847,1414818928,-1414815214,-1936923440,1515873912,808507045,151588620,-1195881085,471602192,909517352,235801096,-1027446723,-488494085,-2038001362,1886408768,336915093,-1364317075,1364320783,1330609508,1802191188,-522149760,1179021928,50559730,-235813782,-1077983097,-2139069021,2105352378,-336911113,-1010591308,-1263219472,269522275,1583225230,-1280062988,-690584920,-892692808,1701137244,-1347428892,1499012234,1128528919,-909513654,-926409277,-1111636996,-1667468877,1212708960,-1330597114,1347425158,1936927410,-1903267925,673758531,-1650622406,-33733351,-1448531607,1077970661,101119117,-2105348392,-1633748280,623234489,1616954659,1044307117,892688602,-1785364801,-1953766956,825304876,1835906521,640071499,488498585,33721211,-1987482961,1903272393,286352618,-1835893829,-2071717291,-1381149025,1785376989,-1431678053,1633760426,757936956,2071712823,-1583228948,1970658879},
		{-1665403403,312650667,-575640982,539506744,247054014,-1104840070,1213890174,-790328180,1004237426,-1172275843,-309572018,-1646257638,-1534205985,-553198115,-1822841692,335103044,1831644846,-912166543,-522671960,-1958234442,-1331903292,1899477947,740766001,-2046949368,1966259388,-2112465065,-215880468,1526257109,606945087,-1467820330,2019973722,-1110957534,-775986333,-2092058440,1091280799,963495365,-1643298238,809247780,1886147668,-1845343413,-1913387514,-1601644328,-13703707,-1057976176,-1131164211,1629726631,-1779821548,-281347591,-1553629056,1604730173,673330742,-1512689616,2034087349,1292146326,2005142283,2086886749,-1980694271,536235341,-1579993289,-496099553,828885963,-1977853607,1548445029,1537423930,-1486846073,1071543669,156361185,-376878775,-93319923,424017405,-620504358,336665371,1048943258,1752319558,-1506056088,-121193798,-564317646,2140013829,1872369945,1937837068,1361019779,-255019852,-1867186948,1764338089,1413573483,132669279,695851481,1391647707,-2025275457,1819754817,1994384612,65886296,1805590046,2100867762,-855664231,180140473,1009986861,2127948522,-2045554608,-954675249,-241738917,714375553,1403597876,-2069501977,1953059667,-2114253041,-1372494234,876159779,-990537833,1270294054,-655457662,1346661484,-1846602989,-1149529454,468929098,1281325433,981507485,869366908,-923099490,561240023,-1264991293,-1800274949,-81009950,1494584717,1481532002,1122420679,-1710734011,-887634234,1670713360,45529015,357233908,-1777906612,0,-1400385071,1030275778,-321412703,1224839569,1724643576,1926947811,-1934628375,1657733119,-444186560,-483004176,-754330412,447260069,-631753419,380087468,134876686,90106088,112439472,223667942,1561365130,-1621709395,847942547,1427801220,628543696,-1238403980,895667404,-1418752370,-226884861,-1021458232,-588544635,-820854335,-1755536477,1323945678,735014510,1257032137,-455233617,-388847962,2060512749,202311945,514695842,-511490233,-159448060,-429189096,1470903091,1146451831,-698926020,471536917,1136470056,-1035589849,-1439407775,-1177737947,199710294,2072707586,-40349102,1337073953,-1445381831,-709204892,-1217094757,1079013488,-723416181,-2002063634,-1713038051,1685933903,-1312347349,-900978391,-295627242,402408259,404623890,-348127490,490797818,580816783,-834064850,-1082223211,915379348,600137824,-148575253,1697030304,1593692882,266490193,1189331136,1858205430,290452467,-174957476,-107129515,-188107853,763158238,-766362821,-1689015638,-1284399972,1737496343,943073834,1791291889,-1198077238,-844859786,-1891454543,936672123,-2136940320,-642421395,647727240,-1305840781,1618495560,-25884150,801794409,-1245565908,-687025197,-1045725313,-362540783,-416221193,1203253039,-1378075074,-1732316430,67438343,-54280771,781289094,-1910940066,666920807,-978421640,22802415,269753372,-1351972471,1459084508,-1572966545,-968679392,1158584472},
		{-651568775,-1036139928,83231871,1916498651,1722705457,733031367,-1857449727,1848340175,793194424,-2091810017,-1407800153,-1866428176,877868201,-833696023,-802828170,1476614381,667035462,-319558623,109905652,417732715,632890829,1730635712,-2010740581,-598287113,-48628411,2118680154,1542544279,274927765,66192250,-1382044330,816132310,941635624,-1740269554,345314538,-868889502,-885929113,861352876,-1893560418,-959724009,-1782606466,-572531450,1755736123,2109373728,184420981,25756145,1214269560,328274927,558834098,534912878,-10289202,-461970209,392632208,1638555956,1517836902,-1486772445,235408906,446503648,-528424800,-1524980312,1267878658,142936318,303567390,1612931269,1568431459,1674666943,-1432638893,-926693347,-1150174409,454302481,1243302643,1792895664,824979751,-623126013,151783695,758918451,-2099739922,1967093214,470817812,-1259293492,-1631019270,-101713606,853422685,234491248,-1901359505,-843264621,708323894,1392333464,-1932489500,1020673111,-1043349230,-253497291,-2074770406,1764714954,-1825401974,-685648013,2059303461,-615326734,-986069651,-1106329927,-1773300220,1842965941,-1133134798,1468159766,1293897206,675489981,384702049,1594318824,-1158104378,2067233748,-1232357817,1324174988,1003633490,-410720347,-224857410,-1808362353,-402266018,2035054943,-1748723723,1359958498,192351108,785264201,-724315127,903492952,1993176740,-436214482,-285085861,510336671,-1424839774,-1550343332,-1714644481,1442403741,-715467272,-765537539,967391705,-951924762,1181238898,1400132457,1125598204,-360781099,2026207406,-2136768411,-1275808823,-1707173243,-1199327155,-1190479428,1909027233,607134780,-486809045,-244649532,-1250314947,-660547448,-216927409,496573925,-18088385,-893859178,701114700,-519446191,1502239004,-1452693207,1443583719,-1578327593,-1575050579,2143387563,1142113529,-1833201029,208866433,-293015894,-1069104925,908604962,260116475,92210574,1117667853,1331974013,1958114351,300552548,582820552,1800694593,-1461671720,-199887798,-1011563623,1883271248,-693578110,2000975701,-310710832,-1341738829,1205946243,1284918279,1029651878,1416647788,1350979603,1872916286,1240025481,1586388505,1649959502,-160500031,1051541212,-1494702382,-98698688,-2049145365,41616011,-1949004831,-74122319,-542842995,1817209924,-2043771247,-1300385224,-1315983038,1088766086,-479009830,549855299,1691706554,-740830452,-808988904,-435296684,-1107509821,1167738120,-1657102976,-1923511019,-1603952602,642459319,-1533828007,-127469365,933312467,-1368543700,-917845524,354161947,-2019063968,1941074730,-135792848,-567419268,-57606988,-1973581296,-995048292,590619449,-174262853,-1343967267,2083749073,1059340077,0,1700554059,-2127920748,-336073948,1559583890,-1623089397,-1665950607,-1081622712,1097613687,-376641105,979057315,426711450,-777203321,-1224558666,117704453,750070978,-1682465932,-1984984726},
		{-1815233389,-451044891,1174214981,569176865,-1178726727,-2053489019,-730122284,38507010,2047079034,-953437753,-1037257278,-112978951,-1427208022,1035303229,1993352566,2073213819,1619502944,-62711812,698968361,215209740,-312998931,-283930129,-200897036,1678895716,324044307,1787408234,-2137179520,-1803474284,-1999069048,1009004604,-814863409,252251151,2102355069,361584917,-1204861000,-1914723187,736295723,1227804233,-1709609062,-1970064758,749628716,-1367816786,-1251092043,-983555131,-1091397442,-1595899744,858602547,-1912242290,-960825146,-413791257,-990811452,1454219094,-1040814399,-599872036,545110560,1592264030,-1417690709,-1565846878,-1222227017,-1258516300,851211570,996714043,314691346,-220507406,76958980,-1167796806,908736566,1796793963,-535126560,122459655,-1128723780,-1886112113,-613270565,1403689811,1257510218,1373702481,1554224988,-1308912463,648045862,1871620975,1433879637,444880154,-1465574744,573974562,504502302,-1381884243,-1655309923,1563614813,1220511560,-622628134,878815796,2018009208,628801061,337383444,-1010959165,951221560,1315067982,-36544771,-174603019,-213246989,-1991644791,1943478643,-343548693,398904087,-1685576037,-293414674,64674563,277503248,-120235272,-660021032,-1839401582,1118932802,454368283,904979253,-1229520202,-6697729,-780389423,1463604823,-1715227495,1963654773,-460533532,-1505927258,1841641837,-2042567290,1277807180,194986251,-1335173712,138779144,-1535717980,989458234,-562741282,712225322,674766888,-1739391592,-1343648593,-2092441213,-677253929,-251557391,1379652178,1090133312,1203145543,1667071075,1097552961,1628892769,1349533776,-1877514352,-367749654,1741369703,2094935420,-1511553883,-899076150,1657550178,26298625,935031095,1956362100,-1625396321,-1083977281,164942601,1757560168,-162717706,-650532391,-789742896,-2129890431,759112749,1702929253,-1405921364,168691722,2131031679,-1556456541,1917216882,-1634786658,-872913205,-136554761,1303937869,222469645,-1940984436,2000776311,-706052395,-498003998,-1141531461,1424362836,-2016301945,-751328813,-1121434691,1047503422,-1306439758,-822123826,-1664831332,-910953271,-90257158,115203846,-1456188503,528699679,-1280309581,1879964272,-760813358,-258948880,-1481894233,-32995842,1767076969,-82869765,796177967,1264933963,1601784927,-853165619,-860557108,425627161,374833686,-1586378335,-937247288,2123743102,-1962771573,2044275065,499696413,-1853477231,-1794088043,0,1542390107,-322352404,821552944,286987281,1503957849,-423148826,1717205094,-2099861374,1341329743,-396425240,1847583342,598171939,-1066981440,416270104,-1755582057,1906094961,657533991,1479924312,-510929695,1073670975,-701454890,828812849,-1765099370,-538675489,-372355351,84345861,-575675171,619444004,1126221379,1817473132,1177010758,1518225498,475630108,786825006,1147949124,-2079623292,958608441,244860174,-473938205}};

#else
u1byte sb[4][256];
#endif

#define q20(x) (q(0,q(0,(x)) ^ byte(key[1],0)) ^ byte(key[0],0))
#define q21(x) (q(0,q(1,(x)) ^ byte(key[1],1)) ^ byte(key[0],1))
#define q22(x) (q(1,q(0,(x)) ^ byte(key[1],2)) ^ byte(key[0],2))
#define q23(x) (q(1,q(1,(x)) ^ byte(key[1],3)) ^ byte(key[0],3))

#define q30(x) (q(0,q(0,q(1,(x)) ^ byte(key[2],0)) ^ byte(key[1],0)) ^ byte(key[0],0))
#define q31(x) (q(0,q(1,q(1,(x)) ^ byte(key[2],1)) ^ byte(key[1],1)) ^ byte(key[0],1))
#define q32(x) (q(1,q(0,q(0,(x)) ^ byte(key[2],2)) ^ byte(key[1],2)) ^ byte(key[0],2))
#define q33(x) (q(1,q(1,q(0,(x)) ^ byte(key[2],3)) ^ byte(key[1],3)) ^ byte(key[0],3))

#define q40(x) (q(0,q(0,q(1,q(1,(x)) ^ byte(key[3],0)) ^ byte(key[2],0)) ^ byte(key[1],0)) ^ byte(key[0],0))
#define q41(x) (q(0,q(1,q(1,q(0,(x)) ^ byte(key[3],1)) ^ byte(key[2],1)) ^ byte(key[1],1)) ^ byte(key[0],1))
#define q42(x) (q(1,q(0,q(0,q(0,(x)) ^ byte(key[3],2)) ^ byte(key[2],2)) ^ byte(key[1],2)) ^ byte(key[0],2))
#define q43(x) (q(1,q(1,q(0,q(1,(x)) ^ byte(key[3],3)) ^ byte(key[2],3)) ^ byte(key[1],3)) ^ byte(key[0],3))
#endif


/* G functions */
#ifdef ONE_STEP
#define g0_fun(x) (mk_tab[0][byte(x,0)] ^ mk_tab[1][byte(x,1)] \
                   ^ mk_tab[2][byte(x,2)] ^ mk_tab[3][byte(x,3)])
#define g1_fun(x) (mk_tab[0][byte(x,3)] ^ mk_tab[1][byte(x,0)] \
                   ^ mk_tab[2][byte(x,1)] ^ mk_tab[3][byte(x,2)])
#else
#define g0_fun(x) (mds(0,sb[0][byte(x,0)]) ^ mds(1,sb[1][byte(x,1)]) \
                   ^ mds(2,sb[2][byte(x,2)]) ^ mds(3,sb[3][byte(x,3)]))
#define g1_fun(x) (mds(0,sb[0][byte(x,3)]) ^ mds(1,sb[1][byte(x,0)]) \
                   ^ mds(2,sb[2][byte(x,1)]) ^ mds(3,sb[3][byte(x,2)]))
#endif

/* mds_rem */
u4byte mds_rem(u4byte p0,u4byte p1)
{
    u4byte i,t,u;
    for(i=0;i<8;++i) {
        t=p1>>24;
        p1=(p1<<8)|(p0>>24); p0<<=8;
        u=(t<<1);
        if(t&0x80) u^=0x14d;
        p1^=t|(u<<16);
        u^=(t>>1);
        if(t&0x01) u^=(0x14d>>1);
        p1^=(u<<24)|(u<<8);
    }
    return p1;
}

/* set_key, encrypt, decrypt */
u4byte* set_key(const u4byte key[], const u4byte len)
{
    k_len = len;
    u4byte i;
    for(i=0;i<len;++i)
        l_key[i]=key[i];
    gen_qtab();
    return l_key;
}


static inline u4byte rol(u4byte val, int n) {
    return (val << n) | (val >> (32 - n));
}

static inline u4byte ror(u4byte val, int n) {
    return (val >> n) | (val << (32 - n));
}


/*
void decrypt(const u4byte ct[4], u4byte pt[4])
{
    u4byte t0, t1;
    u4byte r0 = ct[2];
    u4byte r1 = ct[3];
    u4byte F0, F1;
    u4byte r2, r3;


    r1 = rol(r1, 1); // exemplo: rotaciona t1 5 bits à direita

    t0 = g0_fun(r0);
    t1 = g1_fun(r1);

    F0 = (t0 + t1) & 0xFFFFFFFF;
    F1 = (t0 + (t1 << 1)) & 0xFFFFFFFF;

    r2 = ror(r2, 1); // exemplo: rotaciona t0 3 bits à esquerd
    r3 = rol(r3, 1); // exemplo: rotaciona t1 5 bits à direita



    r2 = F0 ^ ct[0] ^ l_key[4];
    r3 = F1 ^ ct[1] ^ l_key[5];

    pt[0] = r0 ^ l_key[0];
    pt[1] = r1 ^ l_key[1];
    pt[2] = r2 ^ l_key[2];
    pt[3] = r3 ^ l_key[3];
}
*/

void decrypt(const u4byte ct[4], u4byte pt[4]) {
    u4byte t0, t1, F0, F1;
    u4byte r0, r1_rot, r1_plain, r2_rot, r3_rot, r2_plain, r3_plain;

    /* Recupera r0 e o r1 armazenado em ct (note: ct[3] guarda r1 já rotacionado no encrypt) */
    r0 = ct[2];         // no encrypt ct[2] = r0 (sem rotação)
    r1_rot = ct[3];     // no encrypt ct[3] = r1 após r1 = ror(r1,1)

    /* Calcula t0 e t1 usando exatamente as mesmas entradas que o encrypt usou:
       encrypt usou g0_fun(r0) e g1_fun(r1_rot) (r1 já rotacionado). */
    t0 = g0_fun(r0);
    t1 = g1_fun(r1_rot);

    /* Recalcula a PHT (F0, F1) */
    F0 = (t0 + t1) & 0xFFFFFFFF;
    F1 = (t0 + (t1 << 1)) & 0xFFFFFFFF;

    /* Recupera os valores rotacionados de r2 e r3 que foram misturados em ct[0]/ct[1] */
    r2_rot = ct[0] ^ F0 ^ l_key[4];   // ct[0] = F0 ^ r2_rot ^ l_key[4]
    r3_rot = ct[1] ^ F1 ^ l_key[5];   // ct[1] = F1 ^ r3_rot ^ l_key[5]

    /* Desfaz as rotações que encrypt aplicou:
       encrypt fez: r2 = rol(r2,1)  --> desfazer com ror(r2_rot,1)
                    r3 = ror(r3,1)  --> desfazer com rol(r3_rot,1)
       Além disso, o r1 que estava em ct[3] é r1_rot = ror(original_r1,1),
       então para obter o original fazemos r1_plain = rol(r1_rot,1) antes do whitening. */
    r2_plain = ror(r2_rot, 1);
    r3_plain = rol(r3_rot, 1);
    r1_plain = rol(r1_rot, 1);

    /* Remove o whitening (subchaves iniciais) para obter o plaintext */
    pt[0] = r0 ^ l_key[0];
    pt[1] = r1_plain ^ l_key[1];
    pt[2] = r2_plain ^ l_key[2];
    pt[3] = r3_plain ^ l_key[3];
}

uint32_t inverter_u4byte(uint32_t valor){
    return ((valor >> 24) & 0x000000FF) |
            ((valor >> 8) & 0x0000FF00) |
            ((valor << 8) & 0x00FF0000) |
            ((valor << 24) & 0xFF000000);
}

void completar_16bytes(char *str){
    size_t len = strlen(str);
    if(len<16){
        int espacos_necessarios = 16- (int)len;
        int i;
        //memset(str +len,' ',espacos_necessarios);
    }
}

const int tam = 8192;
int main() {
    u4byte key[4] = {0x01234567, 0x89abcdef, 0xfedcba98, 0x76543210};
    set_key(key, 4);

    char conteudo[] = {
150,102,233,107,199,197,231, 73, 43, 42, 81,100,193,118,225,124, 38,162,173,217,226,129, 60,248, 21,101, 80,104,205,118,101,242,113,178,116,131,181,  7,240,102,  2, 38, 87,100, 77,220,236,212,105,204,145, 31,173,190, 15, 84,  9, 34,  3,100, 65,210,239,211, 14,138, 30,134,  0,218,198, 28, 71, 44, 77,117,197,223,103,126,196, 78, 22,150, 10,198, 69, 49, 19, 48, 78, 33, 65, 86,108,125, 27,189, 52,129, 66,253, 50, 73, 18, 34, 74, 96,205,246, 98,254,150,236,243,149,  0, 12,110,241, 20,101, 77,110,192,241,197,236,180, 43,164,202,214,218,255, 26, 22, 48, 70, 33, 69, 85,231,126,  1,115, 19,163,119,129,243,219, 14, 40,  3,110, 69, 82,226,210,193,185,150,148, 20,197,234, 90,  1, 32, 77,101,103,209,103,240,145,128, 99, 64,149, 14, 93,221,  6, 51, 74,101,199,246, 99,118, 80,  4,110, 49,173, 41,156,149,  6, 32,  3,110, 78, 87,225,212,119,114, 23,206,140, 58,184,184,  2, 40, 83,100,206,241,197,227, 39, 88,103, 64,149,129,215, 94, 71, 36, 86,102, 77,212, 69,115, 66, 51,226,101,116,217,141,140,  5, 44,  3, 98,205, 95,108,126,143,137, 40, 56, 40,101,165, 96, 71, 32, 81,110,206,246,110,118, 52,128, 49,141,151,205,153, 34, 19,107,  3, 84,205,118,100,243,158,144,100, 25,203, 89, 12, 21, 71, 42, 81, 98,195,118,103,119,217, 93,139,190,189, 25,194,240, 21, 36,  3,116,193,220,108,240,154,193,125,113,168, 27,182,255,  8,101, 79,104, 68,220, 99,116,  5, 44,237,187,218,186,160, 50, 71, 42, 81, 98,195,240, 69,118, 72, 88,197,  0,141,154,101, 47, 20,101, 83,116, 78, 92,236,212,  8,120,195,120,238,150,210,230, 71, 41, 74,102,205, 80,229, 83,123, 58, 52,164, 24, 91, 28,171, 19,101, 70,102,197,220, 69,118,188,237, 92,146,109,206, 30,121, 11, 36, 64,116,206,246,110,116,136,202, 21, 95,146, 43,220,144, 19, 49, 74,117,192,223, 69,112,254,122,121,169, 88,118, 53,163, 20, 48, 78, 47,103, 79,231,246,204, 78, 57,246, 44, 78, 34,199, 14, 49, 87,104,206,118,229,115,169,142, 15, 14, 67,239, 13, 15,  2, 43, 87,100, 78, 94,111,118,238, 63,120,114,211,122, 11,  5, 10, 38, 76,115, 79,212,236,212,176, 64, 30,233,231,251,118,148,  8, 43,  3,109, 71, 87,225,115,198,104,229, 49,217, 84,244,246, 21,107,  3, 81, 67, 86,108,246, 28, 52, 88, 38,157, 62, 79, 18,  8, 55,  3,101, 77,210,195, 84,178,192,159, 21,250,196,148,123, 71, 43, 76,111,231, 93,103,253,249,194, 12,113,186,181, 14, 94,  6,105,  3,100,196, 85, 97,245, 98,160,237, 67,193, 27,127, 23, 10, 36, 80,114,199,241, 69,108,192,158,197, 80,121,161,141,189, 18,101, 78, 96,205, 92, 97,253, 49, 55,134, 53,  6, 81,139,158, 18, 44, 80, 33, 69, 92, 97,125, 45,251, 25,218,  5,121, 25,229, 14, 54,  3,100, 68, 84,236,126, 92,139,143, 89, 96,170,  4,112, 71, 38, 76,111, 78, 84,228,126,239,127, 95,139,149,114,251,193,  6,101, 86,117,231, 81,239,243,126,142, 37,233,245,233,145,140, 19, 48, 78, 45,103, 84,102,246,242,190,156, 22,249,215,218,117, 71, 32, 77,104,193,246,236,112,144, 46, 29,164,190,243,251,100, 21, 36, 80, 33, 76,220,227,252,231,137,198, 42,179,141,252, 37,  9, 44, 65,116,206,246,110,126, 20,198,232,222, 92,166,140,152, 71,  0, 87,104, 71,208, 69,117,227,192,255,  7, 50, 14,148,112, 18, 40,  3, 98,192, 81,108,118, 35, 73, 22, 21,161,  8, 15, 93, 21, 32, 70,117,224,118,124,246, 27, 30, 13, 50,178,149, 91,244, 19, 48, 80, 33, 64, 84,109,254,109,254, 91,171,235,245,195,190,  9, 33, 74,114, 78,212, 69,114,127, 47,212, 96,236,148,209, 14, 71, 32, 81,110,206,118,229,125,183,224, 98,186,  0,234,177,240, 14, 43, 74, 99, 77,223, 69,126, 93,201,249, 31,234,115, 99, 12, 18, 32, 87, 33, 69, 85,231,126,199,181,103,185, 67, 55, 25,248, 19, 32, 78,113, 77,223,197,114,170,210,170, 36,  2,149,240,211, 71, 47, 86,114, 77,209, 69,246,156, 74,213, 92,116, 45,152,213, 71, 55, 86,117, 78, 92,227,211,214,100,158,129,243, 56,171,  8, 71, 33, 66,113,195, 87,111,125,124,117,  0,125,226,108, 89,207, 14, 54,  3,119,199, 95, 97,126,197,220,219, 17, 48, 18, 45, 25, 71, 53, 76,114, 77,212,108,118, 96, 89,102, 35,223,244,227,135, 11, 36, 78, 98,192,223,109,118,117,158, 12,185, 30,131,143, 81, 21, 36, 85,104, 69,214,195,212,238, 69, 71, 74, 66,197,169,196, 10, 48, 80, 33, 65, 86,239,125,255,140,111, 99,165,123,106,209,  3, 44, 70,117,224,118,241,243, 29,117, 89, 88, 63, 35,247,149, 11, 32, 80,117, 67,212,197,118, 21, 33, 85, 67,216, 19,166,188,  5, 45,  3,100, 65, 84,225,247,202,  4,141, 54, 11, 88,174,115, 10, 38, 76,115, 79,212,236,211,144, 29,173, 67,255,179,204,200,  6, 38, 70,115,199,220, 69,118, 82,142,250,162,111, 31,  4,124, 71, 43, 70, 98,103, 87,226,243,101,162,152, 59,134,221, 16,144, 14, 39, 70,115,192,118,100,115,131, 77, 68,167,  6,199,232, 89, 20, 44, 87, 33, 71, 80,231,126, 97,106,172, 24,158,145,114,198,  3,101, 87,100,193, 94,226,125,163,254,230,245,154,221, 70,140,  8, 43, 70, 98,103,220,239,212,103,  7,156,174, 38,232,226,255, 19,101, 69,100, 65, 82,236,210, 64, 11,168,149, 29, 39,243,122, 18, 40,  3,101, 67,215,111,126,136,233,170,170,120,148, 39,179, 41, 48, 77, 98,103,214,239,212, 84,122,188,126,192,136, 72,247,  6, 40, 70,117,231, 80, 97,247,191,165,130,220, 82,127,209,166,  6,101, 85, 96, 78, 82,111,253, 15,254,237,133, 71,  0, 51, 81,  2,101, 66, 33, 77,209,236,254, 50, 16,126,249,199,137,187, 47,  6, 49,  3,101,199, 94,225,117,249, 90,243,228,251, 94,211, 18,  3, 48, 78, 33,195,212, 69,116,205, 61,247, 98,101, 21,236,177, 52, 48, 80,113,197,209,103,112,146,185,221, 42, 97, 59,104, 80, 18, 49, 66,117,197,118,230,125,231,231,  8, 55,210, 92,175,124, 14, 40, 15, 33,205,220,197,124, 46,  2,  5,129,196,138,236,213, 71, 36, 81, 98,205,246,102,116, 34, 71,251,199,249, 62,119, 79,  2, 41, 13, 33, 86,220,108,116,136, 83,239,132,167, 33,170, 68,  4, 48, 79,104,206,240, 69,118,180, 96, 92, 69,155,172, 44,176,  3, 36, 79,100,206,118, 97,114, 62,226, 54,  8, 28, 79,184,184, 71, 55, 74,114, 77,223,197,113,183,252, 89, 73, 43,121,160,173, 10, 32, 77,117, 77,208, 69,116, 87, 53,231,248,129,152,164,228, 23, 41, 66, 98,197, 95,229,126,141, 69,219,197,252,189,238, 13, 23, 48, 81,116,206,246, 98,118,177,102, 45, 87, 80,114, 89,140, 42, 36, 70, 98,197, 81,101,125,216,183,115, 38,127,142, 78, 45, 71, 54, 86,114, 70,210,109,112,217,240, 31, 79,203,183, 55,204, 21, 44, 80,117, 67, 94,111,118, 90,237, 93, 14,  7,116, 26, 29,  9, 49, 86,108,224,118,115,244, 36, 63,185,162,  7,199, 37,168,  4,101, 69,100, 65, 82,236,212, 34, 88, 91,  2,162,124, 64, 62, 20,101, 87,104, 64, 87,225,246,254, 43,124,224, 88,223, 41,  8, 10, 38, 76,115, 79,212,236,212, 61,203,246,119,141, 95,218,235, 71, 40, 70,117, 77,223,194, 84, 41,111,182,222, 42,156,180, 69, 71, 41, 74,102,205, 80,229, 84,228,106, 95, 84,137, 62,205,188, 23, 44, 65,116,206,118,239,114,250, 82,151, 28,225,132,132,222, 21,101, 70,102,197,220, 69,125,224,125,182,174,240,247,205,234, 73,101,112,116,206, 94,231,115,191,155,235,114,140, 81,119,149, 19, 36, 70, 33,199, 95,100,126,173,144, 77,201,225,192,223,149, 19,101, 78, 96, 65, 84,108,254,177,138,121, 54, 52,202, 25,106, 14, 53, 74,117,103,210,231,212, 56,223,  8,110,219,128,223,124, 10,107,  3, 82,197,212, 69,116,109,103,123,229,205,208,170, 82, 20,101, 73,116,206, 92,226, 82,221,225, 92,174,180,193, 55,  8,  4, 38, 86,108, 78,214,226, 84,190, 30, 20,160, 75,182, 56, 39,  2, 41, 79,100,192, 92,103,253,210, 17, 30, 13, 48,195,237, 59,  2, 43, 87,116,193,118,239,114,  8,155,146,219,202,133,121,200, 21,101, 73,116,206, 92,226, 82,241, 65,152,245, 44, 55,210,213,  0, 44, 66,117,103, 86,111,247, 34, 33,202, 29, 97,118, 67, 60, 14, 49,  3,104,197,241, 69,226,233,249, 25,133,140,163, 17, 63, 10, 42, 71,110,231, 85,231,242, 17, 15,  8,220,144,185,181,138,  2, 38, 87,116,206,246,237,112,190,107,201,139,180, 19,181, 94,  8, 33, 66,109, 69,223,194, 84, 85,229, 74, 52, 37,182, 76,117, 18, 54,  3,107, 77,223,111,115,174, 65,156,132,223,180, 48,164, 18, 36, 87, 33, 77,210, 98,245, 46, 28,237,242, 85,230, 11, 76,  9, 38,  3,119,195, 92,101,118,109,  9,235,205, 73, 53,  4, 65, 21, 44, 87, 33,206, 82,226,243,171,239, 98,162,205,103,121,117,  2,107,  3, 80, 77, 82,108,124,187,182, 69,200,244,151,184,  0, 20, 54, 74,108,103,209,103,240,  6,145,  6,127,163,222, 92, 62,  6, 49,  3,119,197, 80,225,126,140,219,241,250, 78, 84, 44,150, 71, 49, 74,111, 70,210,103,126, 30, 91,203, 85, 89, 19,180, 44,  6, 40,  3,100, 78,214,239,212,224,125,182,174,240,247,192,233, 73,101,112,116,206, 94,231,115,198, 90,144,236,174, 51,102, 82,  5, 42, 81,117, 67,223, 69,115,166, 55, 47, 51,215,182,165, 71, 14, 54, 74, 33,207, 82,229,253,210,101,138,249,127,108,185,227, 11,101, 81,105,192, 81,100,126,241,147,118,224,103, 10,164,179, 21, 32, 87,104, 77,208,194, 84,152,155,211, 24,107,174,187,147, 20,101, 79,110, 78, 84,227,212, 62,122,180,199,133, 18, 21, 64,  2, 54, 87, 96,206,118,239,126,185,155,192,196,227, 61,243,206, 20, 52, 86,100,103,220,239,210,241,230, 24, 48, 97,166,242, 39, 71, 54, 74,117,103, 86, 99,246, 37,254, 61,104,135,134,180,254,  8, 43, 70, 98,103,214,239,212,233,184,181,137,237, 89,187,125,  1, 32, 79,104,206,246,236,112,154,119,214,193,117,168, 91, 31, 19, 49, 74,114,224,118,115,243, 49, 83,206,152,179,113, 73,104, 18, 54,  3, 96, 77, 85,111,118,118, 60, 90,153,233,250,212,111, 21, 55, 66, 33,197,213,102,112,135,183,153,254,123, 41,188,197, 18, 54, 64,100,231, 81,103,245,153,186,  9, 94,108,178,203, 82, 19,101, 73,116,206, 92,226, 84,173,144, 77,201,227, 78,220, 20, 19,101, 78, 96, 65, 84,108,254,170,149,175, 77,210,250,  8,255,  2,101, 70,116,103, 94,111,244,226,167,126, 56,133,132, 24, 44,  9, 33, 74,114, 78,212,197,124, 43, 55,  5, 82,104, 39, 25, 22, 46, 43, 87,100, 68,212,236, 84, 87, 88, 46, 46,  2,103, 30, 46, 11, 48, 80, 33, 69, 92, 97,125, 63,227,  3, 47,104, 95,217,218,  0, 48, 70, 33, 65, 86,100,254, 60,200,233, 66,116,110,119, 85, 14, 43, 74, 96,231, 80,226,253, 63,182,114, 39, 91,230,222,190, 20,101, 66,113, 77,212,226,254,174, 65, 63, 15,223,255,139,126, 20, 42, 64,104, 64, 95,109,126,103,178, 71,243, 55,229, 15,245, 21, 36,  3,117,192, 95,109,126,133, 67,223,237, 71, 60,142,154,  4, 42, 77,116, 70, 82,229,212,159, 99,154,162,132,152,231,214, 23, 32, 81, 33,195, 81,100,118, 63,231,169,144,154,217,210,160,  2, 43, 66,100, 64,223,194,103,  1,162, 45, 70, 27, 23,210,249, 10, 32, 77,117, 77,208,197,118, 18,182,156,214,192,229, 27,128, 75,101, 77,110,192,246,108,254,129,231,147,252,216, 26, 84, 82, 20, 36,  3,109, 71, 87,225,115, 46, 37,228,245,113,148,  4, 13, 55, 45, 66,114,197,208, 99,126,157,255,231,162,222,228,215,106, 71, 51, 76,109,205,220,109,116, 69, 45,150,107,135,242,148,187, 19,101, 64,110,192, 84, 97,242,120,125,158,248, 26, 68, 70,194, 19, 32,  3,117,195, 81,100,112, 67, 81,200, 59,  2,255,124, 22, 71, 12, 77, 33, 70,209, 98,125,203, 18, 34,198,174,184,158,143,  6, 40,  3,114,195,220, 69,116, 88, 80,221,221, 59,145, 61,249,  8, 55,  3,100, 68, 84,236,126,169, 20, 53,217,218, 62,157,232, 73,101,106,111, 77, 84,102,246, 83,  1, 95,162,159,199,227, 23,  9, 32, 64, 33,197, 81, 97,114, 52, 12,118,199,126, 14,155, 69,  9,101, 71,104,198, 92,111,114,219,205,161,215,125,155,179,246,  4, 42, 77,114, 69, 94,111,116,198,130,141, 50, 96,119,208,201, 71, 32, 86, 33,207, 95,231,254,222, 68, 53,215,136,  1,104,  7, 10, 42, 71, 45,103,210,109,253, 46,205,235,196, 19, 23,155,237, 17, 42, 79,116,205, 94,229,254, 30, 64, 66,133,134,173,  8,170, 19,101, 79, 96,192, 95,103,118,195, 91,172,150,225,237,179,128,  6, 48, 68,116,197,246, 98,118, 59, 19, 51,238, 52, 99, 77,177, 55, 55, 76,104,192,246,110,246, 54,230, 17, 81,149, 65, 35,146, 19, 32, 78,113,192,223,197,114,114,133,246,121,174,246,157,202,  2, 49, 81, 96,231, 85,225,243,148,126,168,211,  1, 13, 89, 66, 10,101, 64,110, 64, 85,111,246,169,156,210, 21,119,157,227, 31,  0, 32, 81, 33, 71,215,197,127,249,250,112, 19,199, 41, 93,168, 14, 42, 13, 33,213, 92, 97,116, 43, 96,136,224,208,116,174,149, 18, 40,  3,100, 78,214,239,211, 22, 71,133,114,246,243,160, 89, 71, 35, 70,116, 68, 82,229,126,108,252, 62,135,142,113, 29,176, 71, 51, 74,117, 71,212, 69,114, 94,223, 76,158,130, 50,246, 30, 17, 36, 81,104, 77,223,195, 84, 56, 11,229,131, 91,186,241,203,  6, 38, 86,114,231,222, 99,244,235, 66,202, 50,231,132,130,102,  6, 40, 15, 33, 78,210,239, 84, 92,119,116,118,131, 50, 13,104, 14, 49, 87,104,206,118, 99,112,160,148,154,133,123,126, 63, 42,  9,101, 70,114,205,241, 69,224,161,210,194,125, 81,159,103,  7,  8, 55, 87,117,195, 92,226,125,188,126, 46, 79, 17, 24,176, 49, 18, 55, 86,114,225,118,225,246,223, 56,  9,245,152,198, 45, 81, 20,101, 78,104,231, 94,231,242, 30,221,148,176,224, 33,250,145,  2,101, 86,117,224,246,119,243,240, 37,200,169,218,150,  2,  0, 10, 42, 71, 33, 79,220,108,254, 88,134,228,146,233,156, 46,115, 71, 43, 70, 98,103, 87,226,243, 84,102,241,150,226, 99,103, 77, 71, 32, 79,104,205,118,108,243,211,224,193, 98,194,154,111,254, 14, 43,  3,111,192,209,194, 84,140, 15, 38,128, 62, 95,139,120, 19, 32, 77,117,231, 92,101,245,167, 59,100,  0, 20, 59,217, 37,  8, 54, 82,116,103,214,231,212,227, 79,120, 19,122, 66, 65,176,  8, 55, 82,116,197,209,239, 84, 30,138,133,247,100,237, 86,125,  5, 44, 66, 33, 64, 81,236,254, 44, 33,190,231,122,185, 39, 88, 14, 43, 64,100,207, 92, 98,253, 29, 82,124,109,136, 24,132, 76,  8, 54, 13, 33, 94,212,231, 84,191, 63,239, 51,243,226,221, 99,  8, 43, 80,100,198, 92,231,126,130,242,226,  4,138,159,253, 29,  2, 52, 86, 96,205,246,110,246, 41,105,242,226, 12,191,210,170, 71, 53, 86,109, 76,210, 98,244,177, 80, 37,123,214,115,211,143, 42, 36, 70, 98,197, 81,101,125,182,223, 43,190,199,242,184, 92, 14, 54,  3,113,205,208,110,112,191,186,182, 25,157,253, 74,209, 75,101, 80,100,197,246,103,240,115, 70, 93,214, 86,170, 72, 25, 71, 44, 66, 98,205, 80, 97,125,104,145, 21,122, 19, 59,115,222, 20,101, 81,116,205, 95,111,242, 14,193,129,108,117,248,172, 90, 71, 35, 70,116, 68, 82,229,126, 23,237, 28,254,  0,144,  7, 44,  6, 49, 13, 33, 85,209, 98,246,191,177,128, 90,237,120, 19, 65,  8,105,  3,108,199,220,111,112, 58, 42, 19, 91,197,140,140,164,  9, 32, 82,116,197,118,229, 82,138,186, 47,242,105,206,173,250, 11, 36,  3,100,196, 85, 97,245,162,233,198,  3,189, 58,124,220, 14,107,  3, 64, 65, 82,109,254, 50,166, 86,244,219, 55,180,193, 23, 36, 87, 33, 70,209,226,127,119, 59,186,192, 57,178,125, 88,  9, 33, 74,108,197,209,111,126, 54, 53, 73,207, 98,149, 56,174,  9, 33, 74,114, 78,212, 69,112, 85, 39,124,150,172,  2, 40, 24, 19, 48, 81,113, 67,223,194, 84,168, 59, 47, 20, 57, 67,232,110, 20, 36, 77, 33, 76,212, 99,240,204,146,180,189, 77,170, 86,118,  6, 53, 74,100,192,118,231,247,156,206, 78, 76, 25,244, 47,221,  2, 35, 69,104, 70,210,111,126, 29,231,  1, 53, 49,156,235,234,  2, 33,  3,109, 71, 87,225,115, 39,156,150,137,206,195,118,220, 71,  3, 86,114, 70,212, 69,118, 40, 63, 52,171, 25, 52,154,158, 14, 40, 83,100,206, 84, 97,246, 91,173, 59,204,124,233,174,197,  3, 42,  3,109, 69,209,197,115, 25,209, 21,228,187,122, 75,243, 19, 44, 87,110,206,118,231,253,123,128,206,191, 38, 82,237,207, 10, 48, 80, 33, 65,209,100,243,172,212, 78,179,161, 11,119,220, 10,101, 74,101,231, 92,231,242,249,183,110,227,160, 63,197,168, 14, 33, 66, 33, 65,214,105,112,129,116,115,216,113,109, 39,  2,  6, 40, 86,114,103, 80,229,254, 94, 82, 94,160,249, 95,230, 76, 18, 36, 78, 33, 64, 84,109,254,197,254,237, 15, 54,146,175, 21, 71, 53, 76,114, 77,212,108,118, 26, 45,239, 66,129,199,211,224, 11, 51, 74,111,199,223, 69,112,141,145, 32, 42, 46,207, 83, 61,  2, 55,  3,119,197,208, 69,126,172, 32,140,224, 87,  7,212, 72,  2, 55,  3,100, 78,214,239,211,183,195, 69, 94,209,163, 11, 86, 23, 48, 79,119,195, 81,229,125,112, 27,135,133, 10, 48,227,254,  9, 49,  3,115, 67, 95,111,125,136,178,216,182,  0,166, 48,104, 21, 44, 86,114,224,118,125,254, 44,217,123,242, 11, 18, 51, 50, 14, 52, 86, 96,193,118,225,124, 61,143,194, 43,226, 45,234, 29, 14, 39, 75, 33, 76, 84,236,254,141,170, 29,229,137, 89, 80,  4, 11, 41, 66,108, 70,209,236,124,140,219,237,162, 72, 89, 45, 28, 71, 49, 74,111, 70,210,103,126,172, 20,196,135,190,144, 78,145, 71, 41, 66, 98, 77,223,195, 84,163,200, 20,106, 26,191,216, 73,  2, 49,  3,109, 67, 85,239,114,101,230,111,163, 41,177,168, 63,  8,101, 85,100,193,241, 69,226,144, 83,182, 84,170, 83, 92,184,  4, 42, 77,101, 67, 80,231,115,238,  1,137, 61, 82,208, 13,191, 73, 19, 70,114, 77,210,100,254, 86, 82,188,104, 46, 13, 80, 98,  2,101, 69, 96, 77, 87,225,117,214,128,144, 21, 28, 76,178,207, 73,101, 98,100, 64, 84,229,243,188,201,232, 85,123, 69,187,126, 20, 49, 76, 45,103,213,108,244, 52,247,210,240,152, 54,198, 19, 22, 48, 66,108,103, 86,228,210,216,183,113, 40,123,163, 78, 48, 71, 54, 86,114, 70,210,109,112,247, 10,141,  3, 80,230,154, 12, 18, 41, 79, 96,103, 86,228,212, 31, 77, 77,242,173,114, 69,106, 21, 38, 86, 47,103, 79,231,246,121,203,  5,151, 54, 50,131, 25, 71, 40, 66,117, 77, 82,236,212,  6, 57, 25,116, 59,138,160,236, 17, 44, 77, 96,206,246,111,240, 68,228,  0,158,205,129,144,213,  6, 55, 64,116,224,118,244,253,152,255,154, 51, 28, 14,135,177,  4, 49, 70,117,205,223, 69,112,156,207, 74,192,119, 39,116,149, 22, 48, 74,114,103, 80,229,242,242,128,208,131, 83,182,208,112, 55, 32, 79,109,197,209,111,118,113, 63, 24,125,124,227,250,170,  0, 55, 66,119,195, 84,229, 84,250,118,240,209,193, 96, 98, 98, 15, 42, 77, 98, 77,223,197,118,134,178,182, 55, 57,252, 85,166, 17, 44, 87, 96,197,118, 99,115,171,131,133, 50, 50,119, 42,179, 10,107,  3, 79,205,208, 99,116, 57,132,100,177,122,202,119,119, 14,107,  3, 81, 67, 86,108,246, 72,241,164,210, 27, 42,162, 47, 71, 35, 66, 98,195, 80, 97,125,147, 12,156, 38,  1,254, 43, 52, 73,101,115,115, 71, 84,108,118,211, 13, 66,205, 83,  6,179, 60,  4, 44, 70,114,231,223, 97,243,179, 38, 73, 57,181,206,116,182, 18, 32, 81,100,224,246,253,253,168, 61,  5,134,232,  5,199, 53, 21, 42, 80, 33,205,220,197,126, 42,140, 49, 32,209,237, 58,253, 14, 54, 78,110,197,118, 97,242,196,175,225,127, 39, 29,199, 23, 11, 42, 65,110,206, 92, 97,253,108, 59,181, 76,167,  6,199,128, 20, 48, 78, 47,103,199,108,244, 90, 73,183, 76,  6, 72,247,148, 19, 44, 80, 33,198, 80,229,243,108, 63,114,184,175, 61,115, 48, 75,101, 80,104,205,118,101,242,192,181, 81, 50,111, 33, 78,147, 21,101, 77,104,198,210,197,254,255, 72,149, 11, 66,151,234, 83, 71, 36, 87, 47, 85,209, 98,246, 57, 74, 79,186, 30,161, 43, 48, 14, 54,  3,116,205,118,101,254,204, 49,162,  1, 26,160, 52,198,  2, 55, 74,114, 79, 92,231, 84,132,221, 25,132, 35,152, 71, 48,  2, 48,  3,119,197,208,197,126,190, 30, 20,160,194,178,179,171,  2, 41, 79,100,192, 92,103,253,221,184, 35, 18,173,130,204, 99, 14, 39, 86,109, 77,208,195, 84,252, 19, 31,166,193, 62,176,112, 10, 42, 79,100,206, 92, 97,118,229, 55, 39,244, 41, 77,201, 48,  9, 48, 79,109,199,246,103,126, 65, 99,  4, 34,232,219, 76, 20,  6,101, 70,115, 64,223,195, 84,185, 69,159, 21,132,194, 67, 69, 21, 32,  3,109, 69,215,111,126,176,190,198,161,168,228,161, 22, 71, 32, 86, 33, 78, 84,227, 83,253,193,  1,180,210,250,182,135, 71, 43, 76,111,103,214, 99,240,241, 14, 85, 38,151, 19,  7,102, 15,105,  3,116,205,246,100,240,164,171, 80, 37, 65,123,243,210,  6, 48, 81,104,206,241,197,108,244,250,110,156,134, 84,239,130, 20,101, 77,116, 64,215, 69,246,169, 41, 15,194,234, 46,  7,116,  2, 40,  3,100, 65, 84, 99,246, 39, 63,198,194, 43,255, 10, 99, 23, 48, 87, 96, 77,212,194,212,150,190,  5, 55, 73, 52,141,170,  9, 54, 70, 98, 77,212,111,254,205, 61,247, 98,102, 24, 96,187, 52, 48, 80,113,197,209,103,112, 88, 80, 85,119,190, 13, 38,116,  9, 49, 74, 47,231, 78,231,242, 35, 51,230,106,134, 31,173, 86,  2,101, 75, 96, 70,210,111,244,155,162,125,  8, 33,184,206,248, 71, 49, 81,104,206, 92, 97,124,102, 28,226,108,226, 99, 84,178, 19, 48, 80, 33,197,220,197,115, 81,215, 53, 15,250,216, 41,181, 10, 36, 79,100, 78, 92,229,118,226,199,249,141,105,129, 91,131,  6, 38,  3,117,205,223,109,112,171, 56,237, 30,242, 20,149,121, 20,107,  3, 76, 71,220,108,112, 56, 73,209,255,241,127,103,201,  2, 49,  3,114, 77, 95,100,112,153, 87, 95,146,214,110, 26,166, 20,107,  3, 69,192, 81,103,117, 41,132,243,223, 23,131,108,202, 20,101, 70,121,224,246,253,240, 26,228,151, 40,209,196,138,201,  4, 42, 77,114, 69,215,111,118,240, 62,254,178,101,221,148, 30, 18, 54,  3,100,205,246,110,246,100,153, 47,200,172, 27,126,180, 15, 42, 77, 98, 77,223,195, 84,189,  7,137, 81, 66, 34,177,236, 10,101, 87,104, 64, 87,225,246,188,201,255,219,179,245,121,103, 75,101, 74,111,103, 87,239,253, 48, 10, 95,146,126, 51, 93, 68, 11, 42, 81,100,193,118,225,118,190, 30, 20,160,206, 55,189,129,  2, 41, 79,100,192, 92,103,253,112, 99, 13,107,  7,116, 99, 84, 11, 32, 64,117, 77,223, 69,118,248,141,194, 39,106, 25,102, 35, 75,101, 78,110, 65, 84,236,254,146, 75,129,190, 37,140,191, 63, 71, 43, 70, 98,225,246,110,246, 77, 23,181, 86, 39,211,148, 70, 11, 44, 87, 47, 94, 92,236,124, 12,115,168, 39,118,109,234,164,  6, 55, 64,116,231, 84,111,240,167, 26,207,207,242, 35,163,132, 21, 36,  3,114,195,220, 69,116,154,123,165, 91,245,134, 23, 26, 18, 40,  3,114,195,220, 69,116, 33,154, 15,115, 49,184,100,122, 14, 38, 74,117,205,223, 69,118,142, 28,247, 10,212, 80, 41, 59, 73,101, 96,116, 78,214,100,240, 80,117,192,174,151, 27,121,160,  5, 48, 80, 33, 76,210,111,244,  7,126,203,146,192, 23, 72,105, 71, 54, 70,101,231,213,108,240,242,128,208,131, 83, 53,222, 90, 55, 32, 79,109,197,209,111,118,157, 11,222,123,117,111,197,250, 71, 36, 78,100,205,118,239,253,126, 36,224, 57,203,199,247,219, 21, 32, 78, 33, 65,214,239,126,135,127,188,146,179,118,251, 36, 21, 36, 87, 47,231, 65,239,243,  1,250,141,209,117,123, 11, 14,  2, 38, 87,116,206,246, 98,118, 39, 77, 34,172,252,124,  4,194, 14, 52, 86,100,205,118,108,245,106,200, 86,212, 98,148,  0,133,  2,107,  3, 76,192,223,100,112,197, 78,145,  6,195,215, 72,127, 71, 55, 74,114, 77,223, 69,126,  2,235,100,148, 10, 75,214,129, 71, 41, 86, 98, 77, 92,236,210, 24,194,146, 30, 92,182, 59,  0, 14, 38, 74,117,205, 84,225,115, 82,169,141,245, 14, 47, 48,221, 14, 51, 70,115, 78,214,194,212,215, 79,152, 81,204,237,191, 52, 71, 32, 87, 33, 65,214, 99,118,247, 67,175,240,139,182, 48, 36, 10, 32, 80, 33, 71,215, 69,116,203,  4,120, 58,239, 10, 93,119, 10,101, 83,115, 67, 80, 97,125, 47, 12,182,117, 97,249, 46,182, 14, 39, 86,114,224,246,125,246,122,  4,122,236,116,216,161, 56, 18, 32,  3,105,199, 87,225,126,204,215,196, 86, 73, 78,139,114, 14,101, 87,115, 67,223,111,112,155,212,185, 63, 50, 48,247, 27,  4, 49, 86,114,103,212,239,212,137,171,208, 49, 59,186,237,162, 71, 40, 66,109, 69, 95,111,116, 54,125, 24, 68,143,195,163,188, 71, 36, 64, 33, 77,220,236,252,129, 81,179,175, 85, 78,136, 26,  6, 54, 13, 33, 95, 92, 97,125, 38,  1,205, 93, 50, 52, 44, 45, 18, 54,  3,114,197,212, 69,124,240, 97, 76,  0,192,222,242,232, 71, 40, 76,109, 69,223,111,112,101,204,128,173,189, 39, 15,114, 18,101, 79, 96, 70,210, 98,112, 24,225,140, 28,157,189, 33, 20, 22, 48, 74,114,231, 94, 98,253,207,163,221, 74,217, 91,160, 83, 18, 32, 13, 33, 84, 92,108,245,  1,159,159, 18,167,193,154,190,  6, 40,  3,116,205,246, 99,246,225, 25,112,109,140,162,202,146, 71, 49, 70,108, 79, 92,236,211,188,200,216,128,  7, 30,112,189,  2, 52, 86, 96,205,246,110,246, 74, 20,179, 58,145,254,226,126, 71, 38, 76,111, 68, 92,231, 83,174,143,160,253,151,230,195, 97, 20, 42, 79,109, 67, 87,225,126,113,123,140,184,239,114,142, 57, 14, 49,  3,100, 68,212,239, 84, 71, 12, 32,175,149,209,195,128, 23, 42, 81,117,199,241, 69, 98,184,186, 26, 72, 40,142,126,243,  9, 54, 70,112, 77,214,239, 82,155,162,125,  2, 36,185, 70,243, 71, 49, 81,104,206, 92, 97,124,165, 58,226,136,201,142,229,  3, 23, 36, 87, 45,103, 84,236,254, 57,213,128, 22,118, 25,252,115, 14, 34, 77,104, 78, 95, 97,114,221, 79, 15,  2, 60,  9,251,254,  6, 38,  3, 96, 77,215,111,115,162, 45,215,193,152,103, 85, 40,  2, 61,  3,111,192,209,197,115,115, 70,188, 14,155,227,144,186, 20, 32, 79,109, 77,223, 69,116,  8, 44, 45,169,236, 46, 26,248,  1, 32, 81,108,197,209,111,126,196,184,  5,157,255,254,218,224,  4, 42, 81,113,197,223,197,115, 87,  1,223,250, 13,187,189, 66, 23, 41, 66, 98,197, 95,229,126,175,144, 31,194,129, 33, 77,165, 14, 52, 86, 96,193,118, 97,114, 93, 55,249, 97, 51, 13,169, 22, 17, 36, 81,104, 77,223, 69,126, 71,186, 31,206,134,240,147, 29, 71, 11, 86,109, 65,214, 69,240, 94,168, 10,155,  9,237,188,249, 71, 33, 74, 96,193,246,102,118,174,143,160,253,151,234,198, 96, 20, 42, 79,109, 67, 87,225,126,154, 64,223,205, 30,243,161, 49, 71, 36, 64, 33, 65,212,111,126,227,208,186,115, 34,196, 64, 98,  9,101, 80,100,193,246, 99,118, 55,166, 36,208, 28,  3, 24,189, 21, 44, 86,114,103, 87,226,243,138,157,247, 37,176, 86, 45,138, 14, 39, 75, 33, 64, 84,228,210,248,110, 74,  6,229,110,234, 70, 14, 49,  3, 98,192,209,103,112,209,126, 10, 24, 59,114,232,211, 18, 54, 87,110,224,118,125,254,216, 95,201,192,241,227,233,253, 71, 53, 76,115, 77,214,197,246,145, 51,151, 35,238,  7, 95,  5,  0, 32, 81, 33, 79,220,227,255,  4, 68,180,157,183,230, 87,219, 14, 54, 86,114,103, 84,239,212,117,236,165,  7,122,189,122,139, 71,  6, 81, 96,206,118,239,114,113, 67, 64, 40, 25,220,  4, 11, 21,105,  3,101,192, 80,226,125,126, 21,224, 26, 23,181,165, 60, 14, 54, 87,104, 79, 92,231, 84,247, 50,152,104,144,228,140,166, 71, 41, 76,115, 69,208, 69,114,109, 37,164,174,216, 32, 20,167, 11, 51, 74,111,199,223, 69,118, 31,247, 75,197,155,175,  4, 55, 71, 36, 78,100,205,118,108,244, 97,  8,113,178,116,167,254,175,  8, 41, 76,115,231, 81, 97,253,152,153,117,  8,142,120, 54, 13, 11,107,  3, 87,195, 93,101,114, 23, 76,116,200,202, 67,104,226, 10, 32, 87, 33, 65, 84,228,254,176,119,183, 23,105, 12, 93,111,  2,105,  3,109, 71, 87,225,115,199,255,207,180, 40,255, 98,133, 20, 32, 71, 45,103,214, 99,240, 14,190,195,  5, 83, 10,195,202, 18, 32, 13, 33,211,209,111,118, 80,177, 81,209, 46,205,196,156, 19, 44, 82,116,197,118, 99,116, 62,186,122,237, 45,156,173,249, 20, 48, 80, 45,231, 80,226,245,126, 53,163, 85,120,119, 56,238, 14, 52, 86,100,205,118,226,246, 81,116,189,129,117,145,159,253,  5, 48, 79,116,193,118,231,126,130,173, 25, 32,252, 19, 19, 68,  6, 55, 74,116,206,246, 98,116, 85,166, 28,250,193,235,255,143,  9, 36, 87,104, 70, 92,236,212, 50,192,150, 41,145,165,216,106, 20,101, 71,104,206,246,109,116,100, 15, 68, 36,159,112,214,  7, 71, 40, 76,111, 77, 84,236,210,201,117, 65,126,182, 26,101, 83, 21,101, 81,104, 69, 82,100,254,  1, 57, 60, 73, 28,104, 24, 79, 71,  8, 66,116, 78, 82,236,212, 94, 58,  1, 79, 28,103, 52,130, 10,101, 70,111, 67,208,194, 84, 21,221, 36,117,  4,255,110,125, 18,101, 70,121,231, 92,225,243,169,233,  0,213,132, 78, 96,  7,  2, 40,  3,109, 77,215,111,126,202,122,167,108,110,122, 55, 82, 14, 49,  3,112, 77, 82,236, 84,133, 21, 50,202,103, 34, 96,208, 73,101, 98,109, 67, 94,111,116, 62, 93,230, 88,204,254,244,161,  8, 41, 86,117, 79,214,239,211,118,252,246, 13, 76,215,215,197, 14,101, 77,104,198,210,195,212,225, 15,239,101, 41,141,147,122, 71, 52, 86,104,206,118, 99,116,175,122,154,125,235,247, 86, 76,  4,105,  3, 98, 64, 80, 99,115,231,121,208, 72,253,226,113,  7,  8, 55, 87,110,206,241, 69,228,212,133,  1,145,161,187,195,174, 20, 38, 74,113,195,220, 69,125, 90, 94,169,252,121,212,104,216, 14, 54, 78,110,197,241, 69,226,162, 37,100,232, 25,238,185,236, 18,101, 79,100,198, 92,111,125, 89,244,122,224,189, 98, 37,243,  6,101, 70,102,197,220, 69,118, 63, 18,132,231, 40,189,219,  4, 10, 36, 91,104, 65, 92,236, 84, 47,222, 27, 91,182, 99, 80,134, 22, 48, 66,108, 96,199,108,244,166,218, 62, 10,234,130,250, 92, 71, 43, 86,111,198,118,109,126,160,248,238, 70, 58, 21, 55,115,  2, 43, 70,111,199, 92, 97,125,146,155,247, 39,202,188,147,132, 11, 41, 74,114,231, 81,103,245,189, 77,179, 92, 10, 62,  3,134, 19, 44, 86,108,103,212,108,243, 82,111, 83,168,149,230,188, 63,  2, 40,  3,114,192, 84,229,114, 76, 93, 50,153,254, 79,222,179,  4, 32, 79,100, 78, 82,108,252,249,164,190,228, 72,215,210, 55,  1, 35, 74, 98,195, 92,239,125,255,131, 48, 85,241,150, 69,198, 20, 32, 71, 33, 64,220, 98,245,231, 93, 91, 51,179,235, 22,133, 10,101, 69,104, 64,210,100,254,  9, 16,244, 21, 28, 63,148,141, 20, 44, 78, 47,231, 65,239,242,194,154,161, 29,120, 12, 51,205, 14, 52, 86,100,231, 85,231,242,177,115, 25, 27,139, 82,128,192, 73,101,102,117, 67, 86,227, 84,156,222,117,176,203,216, 46, 37,  6,101, 76,115, 70,210,194, 84,171,129,239,140,  0,249,158,153,  8, 43,  3, 99,195, 87,231,115,227,135,238,144,228,171,  8,251,  2,105,  3,114, 71, 85,225,126,247,181, 29, 41,157,136,146,233,  2, 49, 81, 96,103,214,226,254, 91,135,131,200,193, 10,110,118, 71, 54, 70,108, 79,212,236,212,113, 94,  6,252,158, 87,106,148, 19, 48, 81, 33, 65,210,100,246,191, 63,235, 51,227,239,211,106,  8, 43, 80,100,198, 92,231,126,233, 66,225, 77, 91,112,110,149,  5, 44, 87,116,206,118,108,240,216,  5,189,221,115,181,214, 82, 18, 36, 78, 33, 69, 92,225,211,172,253,242,126, 57,138, 77,242,  2, 54, 82,116,197,246,110,112,116,212, 83,143,157, 85, 19, 43, 14, 36, 87, 33, 64, 84,109,254,210,123,172, 25, 34,157,204, 39, 10,101, 65,104, 70,212,226,246,169, 69, 25, 31,139, 88,142,230, 73,101,102,117, 67, 86,227, 84,148, 20,100,238,161,  3, 72,210, 11, 32, 64,117, 77,223,194, 84,219, 69,215,209,243,229,229,226, 71, 44, 71, 33,197, 80,103,112, 82,254, 12,173,222,108, 93,170,  4,105,  3,114,197,212,197,124,144,178,149, 60,171, 48,  3, 15, 71, 42, 71,104,192,113,117,118, 97, 60,178, 11, 67,197,129,184,  8, 33, 74,110,103,214,239,212, 73,254,253, 98, 58, 80, 87,223,  4, 48, 79, 96,231, 85,101,245,128,230, 32,107,  0,130,193,245, 49, 32, 80,117,195, 87,239,114,170, 15,222,238,105,165, 69, 32, 14, 53, 80,116,193,246,237,125,199, 60,236, 52,115,216,242,245,  1, 36, 86, 98,195, 87,111,125,173,198,185, 49,191, 17,119, 24,  4, 49, 86,114,103,212,239,212,197,240,213,  9, 52, 52,163, 31, 71, 53, 76,114, 77,212,108,118, 99,243,161,163,247,187,164,152, 71, 38, 86,115, 71, 84,200, 84,244, 84,192,120,165, 90,211,113, 14, 41, 74,114, 67,223,197,119,101,253, 77,156, 16,241,101, 40, 14, 43, 64,104, 69,220,226,254, 73, 69,131,123, 71, 92,139, 40, 11, 48, 80, 33,205,208,239,125,  8, 20, 79,125,170, 87,162, 85, 23, 32, 81,101, 67,212,239, 84,111,164,165,142,160,192, 80,192,  2, 41,  3,113,197,208, 99,118,102, 53,154,109,201,130, 15, 73, 18, 55, 77, 96,103,214, 99,240, 43,184,228,103,151,198, 91, 60, 71, 22, 86,114, 79,212,226,246,248,226, 54, 34,249, 23,170,197,  2, 43, 74,108,231,222, 97,244,121, 87,  9,144,144,216,239, 36, 14, 43, 64,104, 69,220,226,254, 60,106,156,182,127,169,116, 89, 14, 54, 15, 33, 76,212, 97,240,103,180,182,  9,  3,121,155,  7, 11, 48, 80, 47,231, 68,111,240,160,210,136,100,206,  0,155,121,  8, 55,  3,119,195, 92,101,118,139,131, 80, 46,226,188,116,106,  4, 44, 79,104, 78, 82,236, 84,121, 14, 57,250,235,234,186,220, 14, 33,  3, 96,231, 85,231,242,149,158,225, 77, 89,180,  4,151,  6, 43,  3,114, 71, 85,225,126, 15,237, 94,181, 74,190,202,104,  2, 54, 87, 33, 76,212,227,212,122, 71,175,138,227,105,179, 73, 73,101, 96,109, 71, 95,236, 84,116,248,121, 27, 55,130, 85, 95,  6, 38, 74,117,195,118,108,115,152,132,235, 34,208, 91, 96,158,  3,101, 79,104, 77,209,108,244, 65,177,  7,137,104,232, 25,148, 19,101, 83,100,206,118,100,243,193,172,137,188,207,110,199,229, 20, 49, 81, 96,225,246,109,246,199,106,207,182, 26,240, 27,240,  8, 54,  3,105, 67, 80,231,115,118, 20,208,188,199,111,100,141, 11, 41, 70,111, 77, 84,108,252, 78, 39,164,249, 79,188, 72, 54, 20,101, 81,104, 78, 92,236, 84,137, 86,164, 24, 91, 96, 22,164, 11, 36,  3,104,192,118,103,254,118,121, 81, 35,139, 44,105,196,  0, 48, 79, 96,224,246,119,254,182, 91, 81,159,159,151,  0,202, 20,101, 69,100, 65, 82,236,212,230,188, 73,222, 58, 33,131, 96,  1, 44, 77,104, 70, 92,236,212,186,204, 16,226, 38,  6,166, 60, 18, 40, 13, 33,221,220, 69,125,217, 97,199,104,130,195,181, 46,  5, 48, 80, 33, 79, 92,101,114,181,122,182,  1,132,134,192, 23, 18, 44, 80,108,192,212,197,125,155,162,125, 14, 33, 57,202,251, 71, 49, 81,104,206, 92, 97,124, 63,209, 79,173,243,122,194, 84,  9, 49, 70,114, 79, 92,231, 84,164,192, 76,114, 89,236, 35,210, 71, 55, 75,110, 64, 87,111,253,141,170,  1,103,146,247, 72,143, 11, 41, 66,108, 70,209,236,124,118, 20,208,182,199,228,234,131, 11, 41, 70,111, 77, 84,108,252,181,241,239,118,194,177, 96,233,  6, 43, 87, 33, 65,209,236,117,145, 22, 71, 65, 51, 75,230,243, 22, 48, 70, 33, 78,212, 98,118,  4, 39, 55, 56,216, 47,231,247,  9, 32, 87,116,206,118,231,126, 79,134,160, 44,210, 74, 17,112,  3, 36,  3,103, 71, 80,103,125, 45,251, 25,  6, 23,246, 31,103, 14, 54,  3,100, 68, 84,236,126, 76,181,113,170,208,177,174, 39, 20, 32, 77,117,231, 93,103,253,228, 72,137, 53, 23,129,127,  1, 71, 41, 70, 98, 77, 92,236,212, 15, 90,180,172,161,  0,198,141, 18, 54,  3,113, 65, 86,100,246, 66,216,151,163, 58,171,158,136, 11, 48, 80, 33, 64,210,228,240,151,159,184, 51,101,133,161,  9, 11, 44, 87, 45,103, 95,231,246,  5,  3,174,164, 11, 61,245,100,  3, 44, 66,108,103,212,233,212,242,128,208,131,211, 54,208, 89, 55, 32, 79,109,197,209,111,118, 34,162, 65, 11,124, 33, 57,161, 23, 44, 80, 33, 65, 82,102,254, 88, 20,244,237,221,127,201, 36, 19, 49, 74,114,103,220,239,212,233, 75, 94,180, 55, 24,127, 94, 17, 32, 79, 45,231, 92,103,242,135,247, 60,127,147,233, 61,169, 21, 36, 87, 47,231, 68,226,243, 27,137,170,220,133,177,112,123, 71, 48, 81,111,199,240,197,112,112, 17,181,159, 17, 14,150,178, 71, 36, 64, 33, 69,223,239, 84
};
 char plano[tam];

     char decriptografado[tam];
	/*
    FILE *arquivo = fopen("cifra.txt", "rb"); // ler como binário
    fread(conteudo, 1, 16, arquivo);
    fclose(arquivo);
	*/
	const size_t blocos = tam / 16;
    size_t i;
    for (i = 0; i < blocos; i++) {
        u4byte ct[4] = {0};
        u4byte pt[4] = {0};

        // Copia 16 bytes do conteúdo para o bloco ct
        memcpy(ct, conteudo + (i * 16), 16);

        // Descriptografa
        decrypt(ct, pt);

        // Copia o bloco descriptografado para o buffer final
        memcpy(decriptografado + (i * 16), pt, 16);
    }

    // Agora decriptografado[] tem todo o texto original
    // Agora decriptografado[] tem todo o texto original
    //printf("Texto decifrado (primeiros 128 chars): %.16s\n", conteudo);
    printf("Texto decifrado (primeiros 128 chars): %.432s\n", decriptografado);

    FILE *entrada = fopen("entrada.txt", "rb"); // ler como binário
    fread(plano, 1, tam, entrada);
    fclose(entrada);

    printf("Texto plano (primeiros 128 chars): %.432s\n", plano);

if (memcmp(plano, decriptografado,tam) == 0)
    printf("sao iguais\n");
else
    printf("sao diferentes\n");

    return 0;
}

